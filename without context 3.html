<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liquid Aura Lab</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        const App = () => {
            // --- CONFIGURATION ---
            const [blur, setBlur] = useState(40);
            const [viscosity, setViscosity] = useState(30); // Contrast in the filter
            const [grainOpacity, setGrainOpacity] = useState(0.07);
            const [speed, setSpeed] = useState(0.6);
            const [showControls, setShowControls] = useState(false);
            const [paletteIndex, setPaletteIndex] = useState(0);

            const palettes = [
                { name: "Visual Reference 1", colors: ['#ff4d6d', '#00b4d8', '#ffb703', '#7209b7'] },
                { name: "Soft Aura", colors: ['#ffafcc', '#bde0fe', '#a2d2ff', '#ffc8dd'] },
                { name: "High Density", colors: ['#ef476f', '#06d6a0', '#118ab2', '#ffd166'] },
                { name: "Deep Teal & Pink", colors: ['#2ec4b6', '#e71d36', '#ff9f1c', '#011627'] }
            ];

            // --- BLOB LOGIC ---
            const Blob = ({ color, speedFactor }) => {
                // Start at random positions within the central "safe zone"
                const [pos, setPos] = useState({
                    x: Math.random() * 40 + 30,
                    y: Math.random() * 40 + 30
                });

                const velocity = useRef({
                    x: (Math.random() - 0.5) * 0.12 * speedFactor,
                    y: (Math.random() - 0.5) * 0.12 * speedFactor
                });

                useEffect(() => {
                    let animationFrame;
                    const update = () => {
                        setPos(prev => {
                            let nextX = prev.x + velocity.current.x * speed;
                            let nextY = prev.y + velocity.current.y * speed;

                            // Strict Border Containment:
                            // We bounce them back when they hit 25% or 75% of the screen
                            // to ensure the "density" stays centered and contained.
                            if (nextX < 25 || nextX > 75) velocity.current.x *= -1;
                            if (nextY < 25 || nextY > 75) velocity.current.y *= -1;

                            return { x: nextX, y: nextY };
                        });
                        animationFrame = requestAnimationFrame(update);
                    };
                    update();
                    return () => cancelAnimationFrame(animationFrame);
                }, [speed, speedFactor]);

                return (
                    <div
                        className="absolute rounded-full"
                        style={{
                            width: '35vmax',
                            height: '35vmax',
                            backgroundColor: color,
                            left: `${pos.x}%`,
                            top: `${pos.y}%`,
                            transform: 'translate(-50%, -50%)',
                            opacity: 0.9,
                        }}
                    />
                );
            };

            return (
                <div className="relative w-full h-screen bg-white overflow-hidden touch-none select-none">

                    {/* SVG Filter Definition for the "Liquid/Gooey" look */}
                    <svg className="hidden">
                        <defs>
                            <filter id="liquid-filter">
                                <feGaussianBlur in="SourceGraphic" stdDeviation={blur} result="blur" />
                                <feColorMatrix
                                    in="blur"
                                    mode="matrix"
                                    values={`1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 ${viscosity} -${viscosity / 2}`}
                                    result="goo"
                                />
                                <feComposite in="SourceGraphic" in2="goo" operator="atop" />
                            </filter>
                        </defs>
                    </svg>

                    {/* The Liquid Container */}
                    <div
                        className="absolute inset-0 z-0"
                        style={{ filter: 'url(#liquid-filter)' }}
                    >
                        {palettes[paletteIndex].colors.map((c, i) => (
                            <Blob
                                key={`${paletteIndex}-${i}`}
                                color={c}
                                speedFactor={0.7 + (i * 0.15)}
                            />
                        ))}
                    </div>

                    {/* High-Fidelity Paper/Film Grain Texture */}
                    <div
                        className="absolute inset-0 z-10 pointer-events-none"
                        style={{
                            opacity: grainOpacity,
                            mixBlendMode: 'overlay',
                            backgroundImage: `url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='n'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.85' numOctaves='4' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23n)'/%3E%3C/svg%3E")`
                        }}
                    />

                    {/* Controls Overlay */}
                    <div className={`absolute top-6 left-6 z-50 p-6 rounded-[2rem] bg-white/80 backdrop-blur-2xl shadow-2xl border border-white/50 transition-all duration-500 ease-out ${showControls ? 'translate-x-0 opacity-100 scale-100' : '-translate-x-12 opacity-0 scale-95 pointer-events-none'}`}>
                        <h2 className="text-[10px] font-black mb-6 text-black uppercase tracking-[0.3em]">Liquid Aura Lab</h2>

                        <div className="space-y-6 w-52 text-[11px] font-semibold text-gray-500">
                            <div>
                                <div className="flex justify-between mb-2"><label>Viscosity (Density)</label><span>{viscosity}</span></div>
                                <input type="range" min="10" max="60" value={viscosity} onChange={(e) => setViscosity(Number(e.target.value))} className="w-full h-1 bg-gray-200 rounded-lg appearance-none accent-black" />
                            </div>

                            <div>
                                <div className="flex justify-between mb-2"><label>Edge Softness</label><span>{blur}px</span></div>
                                <input type="range" min="10" max="80" value={blur} onChange={(e) => setBlur(Number(e.target.value))} className="w-full h-1 bg-gray-200 rounded-lg appearance-none accent-black" />
                            </div>

                            <div>
                                <div className="flex justify-between mb-2"><label>Grain Depth</label><span>{Math.round(grainOpacity * 100)}%</span></div>
                                <input type="range" min="0" max="0.2" step="0.01" value={grainOpacity} onChange={(e) => setGrainOpacity(Number(e.target.value))} className="w-full h-1 bg-gray-200 rounded-lg appearance-none accent-black" />
                            </div>

                            <div>
                                <div className="flex justify-between mb-2"><label>Flow Rate</label><span>{speed.toFixed(1)}</span></div>
                                <input type="range" min="0" max="3" step="0.1" value={speed} onChange={(e) => setSpeed(Number(e.target.value))} className="w-full h-1 bg-gray-200 rounded-lg appearance-none accent-black" />
                            </div>

                            <div className="pt-2">
                                <label className="block mb-2">Color Palette</label>
                                <select className="w-full p-3 rounded-2xl bg-gray-100/50 text-black outline-none border-none cursor-pointer" value={paletteIndex} onChange={(e) => setPaletteIndex(Number(e.target.value))}>
                                    {palettes.map((p, i) => <option key={i} value={i}>{p.name}</option>)}
                                </select>
                            </div>
                        </div>
                    </div>

                    {/* Settings Toggle */}
                    <button
                        onClick={() => setShowControls(!showControls)}
                        className="absolute top-6 right-6 z-50 p-4 rounded-full bg-white/40 backdrop-blur-md border border-white shadow-sm active:scale-90 transition-all"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-black">
                            <line x1="4" y1="21" x2="4" y2="14"></line><line x1="4" y1="10" x2="4" y2="3"></line><line x1="12" y1="21" x2="12" y2="12"></line><line x1="12" y1="8" x2="12" y2="3"></line><line x1="20" y1="21" x2="20" y2="16"></line><line x1="20" y1="12" x2="20" y2="3"></line><line x1="1" y1="14" x2="7" y2="14"></line><line x1="9" y1="8" x2="15" y2="8"></line><line x1="17" y1="16" x2="23" y2="16"></line>
                        </svg>
                    </button>

                    {/* Aesthetic Metadata */}
                    <div className="absolute bottom-10 w-full text-center z-20 pointer-events-none opacity-30 select-none">
                        <p className="text-[8px] uppercase tracking-[0.6em] font-bold text-black">Aura Densities / Fluid Dynamics</p>
                    </div>

                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>

</html>